import{H as h,I as w,i as T,a as R}from"./validate-field-CBWFAOsB.js";import{_ as D}from"./PhysicsPersonForm-g9py70Gq.js";import{_ as U}from"./LegalPersonForm-CI9kQY_9.js";import{r as u,a as V,c as _,o as n,e as m,b as d,d as p,f as S,u as f,S as v,F as j}from"./index-BohIvy7G.js";const M={key:0},A={"data-test":"review"},H={key:1},G={__name:"Review",props:["modelValue"],emits:["update:modelValue","goToStep"],setup(b,{emit:k}){const i=k,N=b,s=u(null),r=u(!1),l=V({email:!1,password:!1}),c=u(!1),g=u(""),{modelValue:e}=N,t=V({email:e?.email??"",password:e?.password??""});e?.type==="PhysicsPerson"?t.physicsPerson={name:e?.physicsPerson?.name??"",cpf:e?.physicsPerson?.cpf??"",dateOfBirth:e?.physicsPerson?.dateOfBirth??"",phone:e?.physicsPerson?.phone??""}:t.legalPerson={registeredName:e?.legalPerson?.registeredName??"",cnpj:e?.legalPerson?.cnpj??"",openingDate:e?.legalPerson?.openingDate??"",phone:e?.legalPerson?.phone??""};const C=()=>{r.value=!1,E(),P(),e.type==="PhysicsPerson"?(s.value?.validateName(),s.value?.validateCpf(),s.value?.validateDateOfBirth(),s.value?.validatePhone()):(s.value?.validateRegisteredName(),s.value?.validateCnpj(),s.value?.validateOpeningDate(),s.value?.validatePhone()),!r.value&&x()},x=async()=>{const y=await fetch("http://localhost:3000/registration",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...t,type:e?.type})}),a=await y.status,o=await y.json();a===200&&(g.value=o.message,c.value=!0,i("update:modelValue",{email:"",type:"",password:"",physicsPerson:{},legalPerson:{}}))},B=()=>{i("goToStep",v.WELCOME)},O=()=>{i("update:modelValue",{...e,...t}),i("goToStep",v.PASSWORD)},P=()=>{l.password=!1,R(t.password)||(l.password=!0,r.value=!0)},E=()=>{l.email=!1,T(t.email)||(l.email=!0,r.value=!0)};return(y,a)=>(n(),_(j,null,[c.value?m("",!0):(n(),_("div",M,[d(h,{step:"4",text:"Revise suas informações"}),p("main",A,[d(w,{text:"Endereço de e-mail",type:"text",modelValue:t.email,"onUpdate:modelValue":a[0]||(a[0]=o=>t.email=o),errorMessage:"Digite um e-mail válido",hasError:l.email,onBlur:E,dataTest:"welcome__email"},null,8,["modelValue","hasError"]),f(e)?.type===f(v).PHYSICS_PERSON?(n(),S(D,{key:0,ref_key:"form",ref:s,modelValue:t,"onUpdate:modelValue":a[1]||(a[1]=o=>t=o),formError:r.value,"onUpdate:formError":a[2]||(a[2]=o=>r.value=o)},null,8,["modelValue","formError"])):m("",!0),f(e)?.type===f(v).LEGAL_PERSON?(n(),S(U,{key:1,ref_key:"form",ref:s,modelValue:t,"onUpdate:modelValue":a[3]||(a[3]=o=>t=o),formError:r.value,"onUpdate:formError":a[4]||(a[4]=o=>r.value=o)},null,8,["modelValue","formError"])):m("",!0),d(w,{"data-test":"password__text",text:"Senha",type:"password",modelValue:t.password,"onUpdate:modelValue":a[5]||(a[5]=o=>t.password=o),errorMessage:"A senha deve ter no mínimo 8 caracteres e conter numeros e/ou letras",hasError:l.password,onBlur:P},null,8,["modelValue","hasError"]),p("button",{"data-test":"form-button__previous",class:"form-button form-button__outline",type:"button",onClick:O}," Voltar "),p("button",{"data-test":"form-button__next",class:"form-button form-button__primary",type:"button",onClick:C}," Continuar ")])])),c.value?(n(),_("div",H,[d(h,{step:"4",text:g.value},null,8,["text"]),p("button",{"data-test":"form-button__new-register",class:"form-button form-button__primary",type:"button",onClick:B}," Novo Cadastro ")])):m("",!0)],64))}};export{G as default};
